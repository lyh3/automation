import paramiko
import subprocess
import os
import sys
import time, datetime, socket, webbrowser
import json
import re
from lxml import etree
from buildingblocks.AutomationLog import AutomationLog

try:
    import dlipower
except ImportError:
    import dlipower
DefaultTimeStampFormat = "%Y-%m-%d %H:%M:%S"
RESOURCES = {
    "COLOR": {
        "WHITE": "White",
        "PINK": "rgb(237, 168, 193)",
        "LAWGREEN": "rgb(137, 232, 126)",
        "SILVER": "rgb(226, 224, 224)",
        "GRAY": "rgb(206, 204, 204)",
        "GOLD": "rgb(237, 172, 83)",
        "LIGHYELLOW": "rgb(249, 248, 214)",
        "RED": "rgb(229, 50, 29)",
        "GREEN": "rgb(10, 81, 24)",
        "DODGERBLUE": "rgb(13,97, 232)"
    },
    "CONST_STRING": {
        "PASS": "PASS",
        "FAIL": "FAIL"
    },
    "ICON": {
        "CHECK_MARK_BLUE": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVMSURBVGhD7VpZbxtVFA4C/gE7PCI2IRbxA5BQPEvKJhHKSxOJlEr0ASQqQd9aqcSeJaWVSMtitwkPAVWlAsQDfSIpqT13pnXbFNSUhLYUQniBIJWINLXjDOez7yjbdewZz3UsxCd9UuS5y3fsOefec07a/ocAzyTZnYqVe1FJsZ2q4QzoFvtK7/NGy6S/VZMdxjOMwVg+rTWgJHMPkWijw3IvkVBft73i5gNjcz2DE6XtQ1f8N45cLRN/4zM8wxias4g5isFSWIMv12T4/k0Jk+m67XoQ39l/bn7Hsd98c/hv/8P8gv9RvrQuMcagsZiDuVhDM10Ha/Id5EMzck9qlptXLVba9snkgn1iVig2DLHGa7QW1tQt95RiuI/z7eLH07tHblFNx6Rvr9R9aLyw7+ScUFQjfO/kP373oYsF7IG9sCffPh60W9l7NNs9vanPK+w+PiMUESd3Hf/Tx14UIJjae/puLqMx6CnvATJi+pWD52/sz14XbiyD+7Jz/mbak3xnGhq4nGhQUs795A9/bclcKBz0isINZfIA7dmVHi9AA7RwWeFA38R9+Da60+PFD07VjkSyiL270heKFCF/2dTr3Mvl1YenPs7fiuiB12kjfonVhAZooV/Gffno0Zu5zNrQKWLA2ZrpE7UIn4EmxWIpLnN9JOzsEwh/zYhOYYloBm2azR7jcquATmyEWcRy0UKtQGijV8zjisXQUqwDp6uMwy4u4tCERtXMqVz2WsCZtg1OLogWaBaHf170M2fFzwJuHZxYIK0Ol70SWtJ9BJe3OO5OUXnm90Uf+PXa+sZYI7PwFV94a8bdprN/bF40sRkMjABmb/j+0PficQE7+8/OUyrQy+UvAbkBrtWiSbK52ojPfhCPW863Pp9C7jPJ5VeAbA2JDvIJ0SSZjGIEaAxf86FZS47ezs2gOxWlnsja6kmK4mRUI0Bo7UCmabHnuRm4HLKdSEFFE2SxESMCkk/PkW+/w82Ao7PDFNJKosEyGIcRYA8dFYrJMtwMultZ7tcoDogGx824jAC3f3qZcn32JTeDIlafe+LNI1eFg0VEjL/4x2JoEXEaAUIz+fYINyOcIekzpfKBFVZM3EaAawwJ+2qFFSXDCHDNqxXF2esVJ8sIsGdgYqWzI/x2Rgi/tUTKNAJ86f1z11eGX8N9IeqBWE2sbCOglfL4YsJwnuNmUFbYl7sDxz3KmKJJtbha9E8zco0AU99WrijP7s3fxs2ooNFL43JjAsgyAsSlkTRPcPlLQFUcBWXRpHop+3VaTvKPecV03uXyl9BusofjSKxgjGwjgsSqagUSqS6q4qLJYTg4Jv48Lm6lsEuOnuOy1wL9CST2SPBFC7QC947y4oPhtHPZYqDC2MrloK7MeEEzXZfLrY6gQIdimGihjeSubyoFukQy9yiXuz4ShmugPIkypWjBjeB+lExtr5CwBAWHakCnCI7fSkVs9ErotXdCFbEBtBVQykdJf6PbClsylbbCikJDGASNHjRb0HQRbSSTQaOHfomZyI2eAOXWm+lO46dtps8ErTfdZlMNGxEADUk0JhEAmhHNEJ2CZmiH7d3FZcQDBABEM4Q/nDM4mEQiGiHWxDmBPRTL3RN7e3o50GQhv/FwuqIqHkfRG3cnrIU1dctjdZ8TcQD9CfIdB5c33ER3HJsqlzHrSc4wBvkEruKYizVwd6p57ZAJlPZxnUZBGYkOsjZUAF8d+LGE4kDwTzWvD1328RmeYQzGIp9QDGePamUf5Mu1BpBpIvUkkW+jKKBa7hdk4CiFz+/wN32exjOMiXwm/LfR1vYvZdR9tON4afEAAAAASUVORK5CYII=''>",
        "CHECK_MARK_GREEN": "<img height='14' width='14' src='data:image/png;base64,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'>",
        "CHECK_MARK_BLACK": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAR7SURBVHhe7dxLqFVVHMfxa2KB2kMltYgkiVBQsPCBotDAcFLaICIaRFSC4MCBigNzJujMqfggyIHvfBRZBkWRTgoMsQc6qFAKJfKR2cNe35+04XD4n7PP3nuttde6rh98kHu996y9f5x79t5rP4ZycnJycnJycnJcZxzux923vsoxo5KexSYcxBlcx7+Gn/El9mIDluFe3HZ5GK/jc/wNq6xB3cRHWIuHMGwzAkuhlW1aWi9/4S0shsYbFtGKPI/TsFbaF727n0TSmY4PYa1gKG/jUSSVO6DPuD9grVRov2A5qmQJPsDHeEHfCJXJOA5rRdp2BNrql+UV/IPO31Wh3jMDF9A5cGy0mzQFvWKVJzvhNfOh/bTugWP0Ix5Hd16FVZ5shrfMw6+wBo7VT5iJIq+hV3k/YCK8RAtxGdbAsTuPR9CvPL1bp8FLJkELYQ2cii3o9QbwWt5IaDNvDZyKbdCO/nMd3yt4LU9Zj+5BU1KUV2Qriv/zXp6OMP5E5wKlZDu6j5XvgXbBvJengTUhYC1YCqzyiuhP2Wt5iiYGrAVLQb/ytEHUXOPsW195igYPPaviyiDl6eeO6hu+8gy6FywFZeV9heJntT/4BLwkxc++KuUV9sB5dADuaybZlzrliQ5LnZ/ISm2/r255hRfhNJ/BGihGTcsTzWQ7iyYhU/nzdVGe/I474SQ6b2sNEpt+5WmmfNDyCs72CXXS2xogJq7LkxVwEp1rtQaIhY/yZAecROcRrAFi4Ks8OQEn6XWtStt8liffoHG0gNaLl7mB1dCZOm2EzsL6ubp8lycX0Ti6+sl68TLdJ7In4BSsn62qrLyvYf1eVbpwqXEegPXiZcajOy5KDFVeYQwape47UH+6VpqUGLo8cRLrhcu8D514slKnxDbKuwInuQZrgDL74KLENsqT7+EkTWahm5bYVnnyCZxkP6wBBlW3xH7laePmszzR+E6yEdYAVVQtse3yZA2c5GlYA1Q1aIkxlCcL4SQ66awLuK1BqiorUTPfMZSnw9dRcJaTsAaqo1+JvRKyPHkXTqP7MKyB6qpSYujyRJe8Oc2DcPVnXBikRJWnWRHr9335DV7ugHoP1oBN9CuxjfJkN7zkKVgDNmWV2FZ5Mgfe4uv05jvQkYWiFXA9fzgoHcN7jc/rY3Rdig7grf8LQeMvgPfo3WItQOp2IUimQlsqayFSpQvNi4+QIFkFa0FS9RKCRodbh2EtTGreQCvRNTPnYC1UKjTXORqtRffiXoK1cLH7DlE8JkC3e7W5+1GHzvlGdSP2LOgeC2thY/MtHkN00e5N7J+JX0CHidHmPujY1lr4tmlr2+oGo0pWQs8qsFYkNO0kv4zkogfsHIC1UiHo2PZNBD3C8BFNg+npF9ZK+qK5yyATAyGzCIegC7itlW5Kl9TpJpm5GNbRlVv6jNQN21ppq4xB6XP2GPTAiNvyQWR3QY9oWgc9WuRT6L7dq+gsShsCPV5AHwU6b6yTXDpv6/TU43DM2P//zcnJycnJycnJyYkoQ0P/AcrDIt9+70CWAAAAAElFTkSuQmCC'>",
        "WARNING_YELLOW": "<img height='14' width='14' src='data:image/png;base64,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'>",
        "ERROR_BLACK": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASVSURBVHhe7dzLq5VVHMbxU5FJRV4iKomEEEFQcFJRGEggTkwaOYygwttAhLTABg6CRv0FUkENjOwiKJpWRmER1UBFMajwFogOLO1mF6vvEy44bH57n3e96/Kud7se+Aw8nL3Xen/u/V7W5UzU1NTU1NTU1NTEzizcgZn//6vGjIr0OF7COziKX/Cv4Wccxg68iBW4Dddc7sUL+BpXYBWrqb/wBZ7FHIxtrsNKfIzQog3zN97HcoxNVLhVOALroFP5Eo+h11mAA7AOMJfduA+9yvXQOe4PWAeV22/YCH0bis9d2A/rQLr2Hoq+JVqIH2B1vhTfosiv9EO4AKvTpTmLxSgmD+JXWJ0t1U9YhM6jTvwIq5Ol0ydxHjrLnTgDq3N9oXPiDGTPDfgAVqf65m1kzxZYnemr9cgWPWH8CasjfaWRHg1yJI/u5jUgYHWi7zScljwaGLAaHxePIln06cs9qpLbp0gWDQ9Zjfr4Cs9AJ+1vrv4slEapV2MNYvwHP4IkCT33aYzuRrjcgg9h/W5Tu3ATXKbjGKzfbepdRM9chI4k65M3mJvRtogq3jQMRsP71u83pWG42xE1Me77ht1rtSnisOIpGou0XuNjHaJG5y6rIR/HoWJZ0c8/gvW6QaOKp8ey07Be50NPWdGiqcdYE0H6pIUUcarifQbrdb40ij353BoUzdtajbTVtoi5iucsRZRo0ttqIISK5FPE3MWT5xAluqxbDYRqWsQuiievIkq03MJqIIapirgVXRRPDiJKhq1ViWVUEYcldfFEg8XB0fOv9eax+RQxR/HkIoKjzlpvnkKTIuYqnhOcu2G9cSo6543Ky7Bel8qtCErOT+Coq62LPqGhAxA+osR649iaFM8lVxE1dxwll2A1EItP8VxURHefmMopREnKUeipbpJ1zht2YUldxGij01qTbDUQqukTRugARFvbECVa0G01EKJp8ZxRtzipiqiB2SjRanirgbZ8i+fkLuISRIm2EmgBt9WIr7bFc3IVUY+vk+dvgvM5rIZ86GIUUjxnVBE1UfUdrNf52IOo2QSrIR+adrTiUzxnVBGfh/UaH08jarSJJfRrvBaDaVM8Z1gRQwv4O9Sv6NEmFqvBpvQV1rytixZ8ty2eoyLqa+uiZ9fQr/B2JMkyWA360KT3ZmiaNMbsmahg+tTJ91d/FuJ+JEuM6c2S7UPSxFgfU6p/8DCSR9unrA703RvIEm1U0ZXK6kRfaaeBdlllywZYHemrJ5A1mmzaCaszffMaOonWzGifhdWpvtC96bAnmizRTp/zsDpXupO4B51H2700f2B1slTn0Ok2r8Fo96P2nlmdLc0JzEdx0e1N6efEQ9Bcd7HRAMFbsDrfNV1tO71g+ETrobV9yjqQ3HST/CR6F+09005I66By0LPt68j6hJEiGgb7BNZBpqKxyywDAzmjHUD6yxmXYR10KC0MfxMPYKwzGzpHaiuBDtoqRlM6z+7FU0gyDF96tJVAq+G1oPsVaFmt/nSKFjdOLpQuBFoxqlOBVgxokkvztlGnHscxwevzampqampqampqauJnYuI/pSXmVnlY7aIAAAAASUVORK5CYII='>",
        "CROSS_BLUE": "<img height='14' width='14' src='data:image/png;base64,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'>",
        "CROSS_RED": "<img  height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJGSURBVGhD7ZnLSsNAFIaLPoT6GmLiQqGQCCqICNIquGmXCi7d6kpRFMU3EPsIXjZCN2JVfAEvO1FBRTdJWwvimNPOlNaexJOEmZQ2P3ybyWRyvsyEkEwiTpw4cTorLJXqtYzhedvUc7ahn6nEMrVDyxyaY2uJHl5OsNjjgwOWod84EixKLFO/tpNaPy/LX6ozYWpX2MBR4NzQQqCZ4csJHTQqYJnx8uhxTsz9HShq4Jnh5dFjm1oeGyxatDwvjx7b0M7xwSLEqYmXR09XipRXlpk9PoIe+4/iVBJtR5EpUtnZYOztg32fHvuWqexusp/be1ZamEGPtyBLREiw988qfmRAQpxHlpEhUpydYD+PT/ViBBSZRgkByBSnDbR/HVkzUl7KOjLPLUV5yWASALRj/ZuQJQL4kQklAcgUASgyoSUA2SKAl0xlf7ulHfAlAagQAdxkMHxLAKpEAIpMIAlApQgAMuzlFZdwlhl2DgnVIm4PNkB5z7iiUsRLQhBYRpWIqwSyzALJqBBxk4B2ynuGhGwRLwnRx1Xm5IguI1OEIiEILSNLxI+EIJSMDJFSJt30LSLwkhBgMvBJUMqk0P51ZM3I1/pqkwxFQtAoAxLlxSzarwlZIoCQqextoce9qMrcPdAkAJkiACwzrJ3E5CjejiFbRBndLdIpv0zhhzE+WHQE+ondltsKhp7i5dFT23LTC9iAURB4owdS23rTLrGBFXPhrJA+XlawwF2wxrS0c0cOsA1LmcA14dqhN0PjxIkTp82SSPwCQFNrym7ccbIAAAAASUVORK5CYII='>",
        "NEXT_STEP_BLUE": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAd0SURBVHhe7ZxrbBRVGIZrvMRrjNGo8YeaaGJi1MRboj8Miu3uUgoKgoigBgwhgjcMYgBjFenOTC/cBEqRi6VcC5VSWw1gINLumW27lJYWKC0XuYMiIHcEOn7fzDfbnbbbmZ3ZhBlynuT8oN33Je/pmXPOd2ZnUjgc7xMQWD+fyCqeL4jcTD9KCn5R7o++PTI33kQ/ur6AYLf6BTYbgirYfIIcpF85YkAeu80nyvlRX1HOol9dPwSywk9CuEYMmJ5TrQTEMARlV9OEcE/6iC3SskJPdfIV5Ct+QX6VPuJ9YESMgM46hyEHz65XCiNnlW/K9qujBYIeysiN3EcfTQi/yEZCZ51XfWfVK4s2o+8BfRQefD1YfS991Lv4BLZI7ShoX6zYrZQ1X1F+3dWmVLReVYbP26Z1oiiXpSjKDSSxBHT84ni+w+Y1aZ0osDWJ+rqOgCSPwjAZuTXKiq0X1JB6w3/3zavVworsY5JYwi+ER1vxxf+fJB4FRgB0TimGwZGBIyQ27Iw/jqtBoV0IZMvPkMoc8AVNGWpxJHf0nR7j20tgT5PKm+BcBJfTAQyEc1RsUGxji/doYQW2PSMzcjvJTEFfnEM13/1d+O5WfeEPuC0RX1eCqyKujrhK/hg+ZQiK8xcuLmoniqyAJJbwSeHX2n3/7ewLi4vWiXI+SbwLjLDJGGbAjDrl5+3/GcIWwQqK2xA1rCC/RRJLwOeDuu/qDr644uu+0PqTxJtghQAjMYRhRhXtNATFJq49oo+WE+k5oUdIZgr6whQho3b04s6+wtrDUd9UsfJhknkT6MBHoZ3EQBJ0WGzQCmgfFTbTKGSbBhYX30gyU1RfkZ1Sfdclz9eV+ILyIAzTGy6torpzhrAlcAn2n7ZZDQud8i1JLOEPhgbrvou3xPeFRSWTJN4FgszHMO/mNyhlO7VNsN7myqfaSzIp/ApJLAHz7AL0HdKFbwGz7+s60nLq74CgOzDsl7CNiQ2K7evSaKm3r7dQeQ/JTEFf6KBm1XdlZ9+Jq+35upKAEHoWwl4MQKCZm/4xBC2HjfEHcxv1eauEJJbwS+w5uEwvqb6V8X1hzlxFEu8CQT/HMG9MqVVWNl40hF3ecEHpk1ejhx1JEkukCWyM7lvcZPRdBqWeXV/3gaWewMoxzIfzO5dk0zb+rQaFjj6HR2KkMkcrISvi+U7d8Jc9XzeSlhO6H4IcxkDflXcu9cYs36WFFVgDHsqSzJSeWfIDoDmC2kkVyfN1JbB6pkJr6yWFlfnVxpJsDaym70RLMjaTJJaAzXOa7rug5nTSfF0JzEcihhmIJdkOY0n2U+SM0is7jAcObTC/9SGJJWChktp9L8f19UtyX5J4k4GZTbfAiKnBsJ8saTEExTb5t0PqaIGOPp4qVT1EMlPQFzqoFrWfLm1Nmq8rCWRXPQYj5jQGyll/1BAUS7KRhTu0sALbkEhJ5guyx3Xf3N+PJc3XlfgkNgTDZEBJtqRDSbaq6ZLSb2pEHzHjSWKJgCAPVX1zu/DdFuMrsAkk8S4wqRdhmKFztirlLcYtyJzQSSjJsAPly1CavUQSS0AFot5LeS/Jvq6jr1R1FwRpxbDjS/40BMU2YfU+fbTsSRUjd5PMFPSFS3mXmS/8Afcm4utKUqXqFyCIWpLNrjxhCIqj5/2CrRRWXkoSSwSCoRejvlVd+LaXkMtI4l1gnhuHYXB+wvkvNuzS+vPqfEadOIwkloj6Tovnq5V6ifq6D7z7JrB1GGbEwu3qihkbdgqVZNDO+KWqJ0hljlrqyetNfQV2NiFfN5KeXf0gTP7HMND3FQcNQbF9Bns7/B3MbZtxz0cyUyz7inJdIr6uJBCU02E0tGHVsLD2jCFoKVQXb/+whTqR5ZHEEt35rmm+rAyaqflCm0IS74IhMAyGwnCxYbHO1Usy2DQHSGIJGIVT4/kujPHFziaJN6FSrw7D4uUVGxTbpPKDNFrYUbw8SWaKmS9e3qovXO6J+LoSnNDViR0C4URvCNvapi4I1IlrcaEgmSnd+eICE/WFBS0RX1eCWwsMg1uNZQ3nDWFXNl5S3qSSzCeGx5LEEj4hNDyeb4cSchxJvAtucjEM3t/oWJLNgk03bpJxs4ybcZJYojtf3MzrvrgZJ4k3wTILyy0MO7F0nyEotq9K9uqXXEuPzI13kswUM18s/1RfKDOxLCSZN/EHq16GIFD4y+pBQGzQX1quKEPztVIPWiFJLNGdL45KPIhAX+joIpJ4E96BDuCXsEP4IuIAvo1xAN9IO4CXcg6BEPwwwS78OMsBlg8++YFqF8CEjRM3Bun26J0f6XcNbhkwCL+pZAN+W9MB/Ma6QyAA/2qHXfiXixzAv97mACqp+Bcs7QIB+Fd87QIB+JfM7cIfc3ACllT8QRv7QAD+qJdd+MOGDuCPuzoEQvAHru1i+sj/dP7If1ygU/hLJ+wCey3+2hMnwPzEX7xjFxh51/bVT4I8hyTeg798zAlaScVff2cX/gJGh8Cly18B6hTYPvCX0DqFvwY5CeChJay0/EXcTuGvgudwrg0pKf8DvFdFCAEyTdoAAAAASUVORK5CYII='>",
        "NEXT_STEP_BLACK": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMmSURBVHhe7dxLqE1hFMDxi5BXnoUJSqIQI5KBlJk8ChkYKAMTkqKIGQMTAxnKIwykDOQxEqHIRIkJUmLgEUrII8//ujm1O629znesfdW6rX/9Bnfyae27r7PPt88+PVmWZVmWZVmWZf2iQdiFo70/Nd84nMam3p/6WbNwG7//WosmW4kXkLU/YBr6RQOxHZ/ROnjiLSbBW+usq64trkP+7dBNx020D9dyGQPwr61A66zT7EDI5KBswSdog1VtRreNxSlo61V9wWyEaiquQhtI8xFyppbW6axrdxeDEaYN0Aax3IK8Qpd0Cdoaln0I1Tlog1j2oKTJeAdtjTrfsRBhmoBX0Iap8w3zUdJ6aGtYHmE4wrQK2iCWBxiKks5CW8NyGKE6AW0Qy0GUJNd/L6GtUecXliFMo/EM2jB1fmIJSloObQ3Lc4xBmOQ3Lr95bZg6TzEKJR2DtoblJEIl//dog1iOoyQ50HLAtTUsaxCmEXgMbRDLapS0FN2e5W/QxHvx/9Yi/IA2TJ3XmIiSDkFbw3IBoToAbRDLeZQ0DA+hrWEJtXc4BPehDWIpHXIBuj3Lw+0dzoO869CGqdPNkPuhrWEJt3e4F9oglhsoGVLO8nvQ1rCE2juUnZc70Aax7ERJc/EV2hp1wu0dzkT7Nn8nclDmoKTd0NawhNs73AZtEIv8ecqfaafkLK/exCoVau9Qtv6vQRvEIpdDJc1AyW2FqnB7h3ILQF5ltWHqyKXKYpS0FdoalnB7h3Kdpw1ieYKR6JSc5VegrWEJt3d4EdogliMoaQreQ1ujTri9Q3ljLzfbtWHqyJCyJ1jSRmhrWMLtHa6DNohFdqXHoyR5X62tYQm3d3gG2iAWuQtYkuzsyDaWtoYl1N5hHkBH+SfsKF9EnOVljKO8kHaUb+Uc5WaCs9zOcpQbqo5yS99Z3lRylLc1HeWNdWf50Q5H+eEiR/nxNmf5AUtH+RFfR/khc2f5mIOjfNDGUT7q5SwfNnSUj7s6yweuGygf+W+ovv7SiepXnWjCfulENdlny689aaD84p0Gklfa/OqnLMuyLMuyLMuyPqqn5w9UWZAzlFEBZQAAAABJRU5ErkJggg=='>",
        "ARROW_DOWN_BLACK": "<img height='24' width='24' src='data:image/png;base64,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'>",

        "ARROW_UP_BLUE": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAUBSURBVHhe7Vw7bBRXFLUipDQpaOhS0tLSQrXeREiRaIJEQ0EaqOIqqZYm2UVRwkeKEIICioRPAQWESEkkS0jetU0MjoMEBIgR5g/CICviz8s7w728Ybj2zuy8nXm7e490pGHuu593GWbnnTfDkEKhUCgUCoVCoVAoFIowUN116sNKo7UPxDGdVqRBtTH+8XC9NTHcaJmI9hjnyKxYCrZZa+1Vdw+N2/jj2Yg4js5ZGw1TSLCNGrF8gYaN/HzB/H3neUQc4xzZRmi4grGmNvpRpd48hCZVLXf+dt1cnX9lZh+9johjnIMNYzAWPuQ+2Kh821xZqbdm0JjPfpg0x6cfvG1ckrBhzJsmtmbgS2EGE5XtY+vsfW0eDdm0d9qMX/tPbFycGIOx8IEvYlC4wUGtZj6oNJo1y1doxNdHL5mL91+IDZOIsfCJrkQbA7EQk8L3N9bsGF1ur5wTmHx1+7jZM3rD/Cs0qR3hA1/EoKvxBGJTmv7EJ/XmKjvZy5jw+p1nzK/n58XmZCFiIFbURBsbOShdf8H+gm6wE1zARL/YP2OmbjwRG9IJEQsxqYkLyBUl7QfYx41l9rHje5qc2XbsivnnwUuxEXmImIjNeZATuamM3kT1m9Mr7A1+FBP61N6rDozdFifvk8iBXFETbW7UQOX0Fmzxq+1VMIeJfL57yvxx8bE44W4QuZCTrsQ51EJl9QaG683N9kH3KSaw5cB589etZ+JEu0nkRO43TbS12JqovHDBEhSKBhu/zJorD92SrGgiN2rgeoKWxuIS1LrvJszhyXvipMogakFNUSNDlMZsUe9IUKevLogTKZOoKUhpzBb0ngQlTSAEBiWNtZOgQmUQ0lgWCSpUliaNJSWo1mx7CSpUovbCpLG8ElSoLEQa8yVBZSV+OYv4Re+qNNYNCSoND03ejZ7dQBxLY3zTuzTWTQlqMWL1UD/pVg9MnCtiVYM55pbGipKgkpy++cxsPfju+jW+roYNYyRfn8wljZUhQYG/X1hcQcExzsGGMRgrxfDNzNJYstCiJKg0hZb1F5taGitDgsI/lVqGfyrJWwt8i7i1pJLGuKiiJKg/556YzR3erOM/boiBWFIOn0xKY1SKAxskZ9885eFxIfl4hZhSLt+kmstpoO8H1jIe8LlPVIIDGyQnH8SS6asjbslkJ77Nx5IJMRArimljI0c3l5jcJ0rvwAbJKS+LWLQXJXJwnyitAxskpzw8fq442eg9mc3mlmrKQ+4TpXRgg+TUCcsSLpEDuZATuX0LvdwnSufABskpKyGdf/lTudI5clLuqBZfWw2IB1IaBzZITlkY0uYNcvve7OI+UQoHNkhOaRni9qHv7VbuE4V3YIPk1I6hb2D73PDnGBTagQ2S01KEvNQrr1Ak1/udSGPcJwrpwAbJaTH24ks8qBG1ouZOFCfuE4VzYIPkJLGXXyPLI41xnyiUAxskpzhzqbUBISmNpVXdeTyFcWCD5MSc6sNXaePSWJp9H5p79gb288vcWXYeaf7pGzgonxOklca4T+TmwIb44OSuvU3gRYIKFUlpTHr7gvtELg5s4IGD/ElVUhqLf4LGfaKhDmzAIP2oT5DG6A007hMNc2DDLv2s9C2S0hh6w32iIQ5sIOqHzTGgF9ST9g0M6v3hgICesDS2eAP1P3dYEnFpjE45hCZBhQqWxuiPCoVCoVAoFAqFQqFQDBiGhv4Hp2LYqtH/L8gAAAAASUVORK5CYII='>",
        "ARROW_UP_YELLOW": "<img height='14' width='14' src='data:image/png;base64,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'>",
        "ARROW_DOWN_BLUE": "<img height='18' width='18' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAUISURBVHhe7VtLjAxRFJ2IxMbCxs7S1taWVU8TicSGxMZibFixYtU2dItgSESEBQvfBQuMBMkkEt1jGMYnMb4j/oYYIuI7nne6753Xyq2ZrqrXVa+730lOMlP33fvuPaJ66rzqLg8PDw8PDw8PDw8PDw+PTkWuVDmY39M3i371CAE0glb0q0F3qaK6i5Vr+dLAPLrkEQC0gUbQii4ZVAXU1OqO6UWL6bIHAZpUtSGd6LIBB4i/NDdSqOMBLUiTSY0oZMCBPRefqzz9nCuWjy8q9M+mJR0HzA4NoAU0gTasEy0x4MDopz/qzPAHtXzXIIlYuZPbVp5PyzoGmBmzQwNoAU2gDetEyww4gEXgwLOvas2B4VpCsTKe2351GS1te2BWzIzZoQG0YF1YJ1pqwAFeCI68/6U2n3pQvZ4rlSc0C4WCmkEpbQfMhhkxK2bG7NCgXhPWiVIMOFC/GHyqub//pcpvH6glFytnF+3un0NpbQPMhNkwI2bFzJg9qAfrRGkGHAgmMC/cG1creq9zgUdLiuUFlNrywCyYCbNhRswqaQDS/NEFBIdeflNrD93hIl/0J9OqWnbrAjNgFsyE2Yb0jNLsTJo9noDgww+/1ZbTjycL6Y/5nfrjfiaVaRmgZ/TOc2AmzCbNXE9eT2UMOCAlSTx89Y1aSvdFfdPtz2+9MpdKOQ/0ip7RO2bALNKMElknKmXAASkpjJdHPquVe4dqIhbLL3RTC6mcs0CP6BU9o3fMIM0WRtaJyhlwQEqaisOvfqh1h++RiJXv3cVyD5V0Duit2qPuFT2jd2mmqcg6UUkDDkhJ0/HxxwlVOj86Wdw1a4wtKO4PvaJnaZbpyDWotAEHpKRGeWJwTC3bca22iSPWWL0Fhd7Qo9R7o2SdqLwBB6SkKLzy5Itave9mtVbW1hj2ZgsKPaE3qecoZJ1oCwMOSElRefftT7Xh6H3eLBNrDHvS3tVe0JPUa1SiHkjbGHBASorDJ+MTqjcDayxoQaEH9CL1GIesE21nwAEpKQnP3ErPGvvPgtJ7Sz0lIetEWxpwQEpKyspo862xoAWFPaVekpJ1om0NOCAl2SBsoU0n7VtjQQsKewQtKJtknWh7Aw5ISbZo2xpr1IKySdaJWjDggJRkm30WrLGgBYWa0l62ST2HC5jkr/QovPHim+qJaY3VW1CogVrSHjYZfNqiVgyCz4m3X0d/ToxK2EeFCNZY0IJCbiMWVFJCi4ae95M6FXHZiDWWxIJKwsiOU1aNXrof3ih+rv+HxVqphm3G9jzjurVJCXtp/ZF//6vU31oQi2NBRSVmteK6Rz0vsEHcrIvnzM2aiWtpfLhhRqvnPlFOrGzy+OC7qv0E4mdpjW027eQxiz9YQdhPNiyo6ZjK2TcemXThLfpmGnpq34oMvn2BGZv69kVaD+1pMA2TQ0TYm0utxMzfQGu2cdksZmX0hkI3MWmdbzxmzzpvBtEbekSv1LMbb+Hq+4f1wxvbdOmwS4Tt40ObdPG4VYTNA2wbDFpQ6K0lvguThTUWZMMWlKsIOihpWWNgK770JCILayy2BeUq0rLGrFlQrqKZ1hhqtdurxyKaYY2188vvImxZY6lYUK4iqTWWugXlKqb6SlUYO/kraCKiWGP+S5AhmM4ac86CchVanP+sMWctKFeh72v/WGNOW1Cuot4aq9JlC8pVsDXWMhaUh4eHh4eHh4eHh4eHh0dHoKvrLyaz2KoVwESPAAAAAElFTkSuQmCC'>",
        "ARROW_DOWN_YELLOW": "<img height='14' width='14' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASNSURBVHhe7ZtPSBRRHMclgi4dunTr2LVrVzvZ6m5JBEVdOgTiyQ5BFAQL0Z9LkJWF7LK7mhFFHTyU+W/cSALJQ0ISQcaSlGVoiO5mZjq97+yb2VXf/pmZ92beuO8LX9Dd+fP7fpeV3c971ikpKSkpKSkpKSkpKSkp1aoGYqF43+3QLvqrUgmhI3RFfy1oMB7SR5KRyb5YaB99SGmT0A06Qlf0oYLwYGbs0upwMrwwFD98iD6sRIVO0A06Klmg/qtHn/94Ux/pOpobTjReoE/VvNAFOkE36KhsgfDy1079zeMTWa0r0pvuqN9ND6k5ITs6QBfoxOynYoHw2lyX/v5l67KWinzujzfsp4fVjJAZ2dEBuijupqoCTU+PX14j7/3F/lhDhB667YWsyIzsrE5sFQgvTN3S093NOS0RuRaNRnfQU7adkA0ZkRWZWV3AtguEV77H9LFnp7Pkj6mWTjXvoadtGyETsiEjsrI6MO2oQHh9rlv/MHLuD/nb8G2ws/EAPTXwQhZkQjZkZGUvtuMCTc9MXFnXkpHsYKzpFD09sEIGZEEmVlaWXRcIL2Xu6q8eHiMfdcId6Wj9TnqZwAgzY3ZkQBZWxlLmUiD890dCH+89k9VSR972JUJ76aWkF2bFzJgdGVjZyplbgfD6fI/+6fX5FS0RniOfnQ7Sy0krzIhZMTNmZ2WqZK4Fmp6dvLFOXtXcUCLcQi8pnTAbZsSsrAzVWkiBcO7LPX300XHylo70yITGMAtmwmyYkTW7HQsrEP73M6lPvDibkwWNmQgKM2E21sx2LbTAvB/ombGLq5rPaAz3xgyYBTOxZ7VvDwrM2080thlB8bRnBcIGGnty0jM0ZiEocs9iBMXTnhYIG2hsoPU38JBINGYhKHKvzQiKpz0v0LRINFYJQfG0bwXCC1PteTSWDF/lgcYMBEWulUdQ7cx78ravBcIrM3EuaGwDgiLXZN1LhH0vEM6jsTbHaKyAoNqqQlA8XbLA3PR95gkiDYw0nIos2UFjOBbn2EFQvIyOmAUWvide93woC40ly6MxA0GRY5wgKB5GN2W/7/MgFU69Opssi8aKERSOZV1DlG0RJ7eszI2NQUe3Dmq9sOQ5r19YR8yzmNYuZu4wLyzSBTQWaoHxs1sE5cTI7oq6O1kv4GUTjfFCUHbNbd3H7ooVTwM/8UJQ1VrIyqP1gfVp5TXTINtY+yYZ3X7AZwpfmYZSTRVX7YNqc/cFMgrdfeHll3av7Pn+HwsbMXYuBcm+7kArtXcuKJZmD6RIdC7K0u3CLewf5rt4w9/5xS7MKt0+cHP58N1zfsuHPI2ZMJvU/4mwYQHbBzRWyphFxgX/kuK1hYKHg7DlhCmLoPiAxmBbCEpW+YXGgrrtjqliiuwFGrMQVAW6HTh5gca4IShZJWolze0KX6DEG40JRVCyykBjCfdozEJQ5FpCEZSscoPGPEdQsspCY/3V7agyEBQ5Fud4jqBkVbVoTBoEJavKoTHpEJSs2orGJEZQsqoYjUmPoGSVicbgQCAoJSUlJSUlJSUlJSUlJaWaUF3df3C/WwoppHD8AAAAAElFTkSuQmCC'>",
        "ARROW_RIGHT_BLAK": "<img height='18' width='18' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAATlSURBVHhe7ZpniCxFEIDPgBkTZkVFUTGBGUQxIAhifiLmgIpZfyiiYkIx54BiAAOIoKhgQAwYUQQRsyjmhIgRcw7fB6+lGHbvZu7dzuze1QcfvLu3e1NbO91dXT1jSZIkSZIkSZIkSZIkSZIkyfRlHjwaj8X5/UXSjKPw39k+h8tj0oALsCRQP8PNMKlJNYH6Kx6ISQ16JbB4GTpHJuMQE/gifhd+1kdxSUz6EBN4Ha6Jb4ff6Xu4DiY9qCZQFsMHMSbxB9wVkwq9Eihz44X4D5b/999n4lyYzKZfAgt7489YXqN34yKYwEQJlI3wE4xJfBVXwxlPnQTKMvgMxiR+jdvhjKZuAmU+vAFjEv/E43BaszA6DPfAk/AKvAXvxQ+xbgILR+IfGBN5M06bZsRKeBjehm/gXxg/bD/rJlC2wi8xvv95HNlmxOp4Bjq5xw/VxP2wCavgSxj/xkg1I6zVdsenMdZrvfwKfd3teDmegIejd+qeuClOBqeHOzFey2bEQTi0mLh98V2MgRedn1wxz8HtcWkcJBbWp+LfGOPwixq6ZsSWWB026jx3P9qGWgK7YGf8HmNcQ9OMWBSd5Kvfst2T83BlHAbWxncwxmgzYj3sDEuQalA/4tm4OA4bjoCHMcbbWTPiYPwNYzD34bDccf1w7rsYY9wudMdja3iHxdXV+eUAHCVOxJhER87AcVVztxAv/BaugaOE9aB1YfwcD+HAuQrjRR/HrlbWyeJIsR6Mn8N60bpxoJyC8aIWvwvhqODc52FU/AxWDqfjwBuxFr2xTHkBba+PCo6SRzAmz3nb+nDgLIdfYLnwa7gUjgoeOlV3Rv5sXThw3Jo9huXCP+FaOCrsgtZ5MXnWga3N2/bo4sWt/eYU20qb4z7oPtVGqCvgk+j5r22u99GW1LfoKr8uNsE5zbmtujuy/mttD7wCWhuVi9staYrNgp3wXDRB1buhrldiXVxN78L4flfd/bFVbsUSgC2nuluzDfF89M6JH2JOrNtQXRVfwfjeT3ETbBUvGHcaPqc3HjZNTVq/NlYvf8HX0e2fHepr0L9xMh6BD2B5bZ0EboN+0fEaPha3LLZO3HA7J82LvbCid7iM15p3HjJR1+OhuDWuiBPR5FDpGKyehdyEnZyFbIDx7tsRq9iFeQJjwNGP8FL0vZOtF+sk0NO4GzFe20Sa0M5wOJVg3sRYpTsPXo297jhrRSd7V9ipqOwnSqBD81mMMTiEt8XOsMT4HUtAh2BhB/wcY8DqvOectQBOJeMlcGN0cYhxuHi4iHRKrPtMlkPEu8kHd6o11ce4F1psD4J+CfTMxQUoxuI8PPBmQB1iCWDRuSC6SsZgPfG/CAf9EE81gRbAXjfG0lozoA7rYwxuC6xuwL3r2qqpYgLvQHcrMZbWmgF1sctcgvsAq2cH7onbbCLEBFZtrRnQBB9/KAFWzzruQefDNumXwFabAXXxfLRfMewc2HbypFcCW20GNGEWVoPVl7GrrvNpWOLopBnQhEswJk6/wS7rKmtS510fBWm9GdCUp7CawKno/c0Yqn06e3dDUVuNAg6VmDx1P5vUxII5Js8uS9IAD5pjAj2rSBpwFpbkWQuO0nnvUHAtlgTaX0sa4mlbSaDnEklDPJstCbS/lzTEvaULyW6YtV+SJEmSJEmS/M/Y2H9vz1fQ+B9SXwAAAABJRU5ErkJggg=='>",
        "INTEL_LOGO": "<img height='50' width='50' src='data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxIPDxMQEA8VEBAXEBUVFRUSExYYFRYXFxYWFxUVFhcYHSggGB0lGxYWIT0hJSktLi4uFx8zODMsNygtLisBCgoKDg0OGxAQGy0lHyUrLS0tLi8tLS0vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK//AABEIAOEA4QMBEQACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABgcBAgUEAwj/xABJEAABAwIACAsEBwYDCQAAAAABAAIDBBEFBhITITGRsQciMkFRUmFxcoGhFDVzsiMzQlRiksEWNFOC0dIVosIXJENEk+Hi8PH/xAAaAQEAAwEBAQAAAAAAAAAAAAAAAQQFAwYC/8QAMBEBAAIBAwIFAgYDAAMBAAAAAAECAwQRMRIhBTIzQVETcRQiQlJhgRWR8GKhsTT/2gAMAwEAAhEDEQA/AONNK7KdxjyjznpK9PERs8xMy1zzusdpU7QjeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5M87rHaU2g3kzzusdpTaDeTPO6x2lNoN5YMzusdpTaDeUzyz1jtKp7Lu6Gzct3iO8q5HClPLRSgQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQYKCZqkuohPy3eI7yrkcKc8tFKBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBBgoJmqS6iE/Ld4jvKuRwpzy0UoEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEGCgmapLqIT8t3iO8q5HCnPLRSgQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQYKCZqkuohPy3eI7yrkcKc8tFKBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBBgoJmqS6iE/Ld4jvKuRwpzy0UoEBAQEBAQEBAQFAKQQEGAUO/w+gicdTXHuaV89Vfl9dNviTMv6jvylOuvzB02+JaOFtYt3qYmJ90TEx7ClAgICAgICAgwUEzVJdRCflu8R3lXI4U55aKUCAgICAgICAgIOhgzAlTVfUQPkHWAsz8zrD1XLJnx080utMGS/lhKcH8GdQ+xmmjiHQ0F7v0HqVSv4jSPLG67Tw60+adkhouDWkZpkfLMe1wa3Y0X9VWt4hlnjss18Pxx5u73f4Lgqn5UVM0j+KWuP+clc/rZ7+8un0cFfaGwxgwXFobNTj4bQflCj6Ge3faU/WwR7wx+3ODm6qgeUcn9qmNHnn2R+LwR7tm49YPP/ADNu+OT+1ROjzx+kjWYZ/U+0eMeD5dHtMB7HED0cvmcGaPaX1GbDPvD6OwJQVIv7PTyfiY1l/wAzdKj6uanvL6nFiv7Q49fwc0cmmMyQO/C642Ov6ELvTxDLHPdwvoMdu8dkTwvwdVUN3QltS3obxX/lJsfIq7j8QpbtbspZNBevevdEZ4XRuLHtLHjW1wsR3gq9WYt3hRtWa9paKUCAgIMFBM1SXUQn5bvEd5VyOFOeWilAgICAgICDLGFxDWgucTYAC5J6ABrUTMRG8piJmdoS/AfB7Uz2dMRTRnmcLyH+Xm8z5Kjl19K9q95XsWhvbvbtCUR4MwTgz617Hyj+KRJJ3iMatipzk1Ofy8f+luMenw+bl5MIcJ0TdFPTuf0GQhg2C53LpTw60+adnxfxCkdqwjddj/XS8mRsI6I2C+11yrVNBirzG6pfXZbcdnBrMJzzfWzySdjnkjZqVimGleIV7ZsluZeMNHQurmygICbAgzG4tOU0lrhqLTY7QomInlNZmvld/BmOlbTkWnMrOrKMobeUNqrZNHiv7bLOPWZae+6cYC4RIJyGVDfZnn7RN4yfF9nz0dqzs2gvXvXu0MWvpadrdkiwxgWnrowJmB+jivaeML87XD/4quPLfFP5ZWsmKmSO8KmxrxTloHZX1kBNmyAauhrxzH0PotrTaqubtxLG1Glti7+yPK2qCAgwUEzVJdRCflu8R3lXI4U55aKUCAgICAg6GAMGirqWQGQRB2US8i9g1pcecdC5Zsn06Tbbd1w4/qW6U2/x7BuCwWUcXtM+oyX5+2QjV2NFln/Rz6id7ztH/ezR+tgwRtjjef8AvdGcMY5VlVcGXNRn7EXFFugu5R2q3i0eOnfbdTy6zJftvsj56edWoiIVpmZEQICAgICAgICAgKBJ8T8b5KF4jkJkpidLSbln4mf286p6rSRkjeI2lc02rnHO0z2W6RFVQ/ZlhkZ3tc1w0LF/NS3xMNrat6/MKWxvwAaCpMekxO40TjrLecHtB0bDzre0uf6tN/f3YWpwfSvt7eziKyrCDBQTNUl1EJ+W7xHeVcjhTnlopQICAgIfynOCeDo1EEc4qg3LYHZObva41XytKzcniE1tNdmlj8Pi9YtvyjWMuBvYag05kzlmNdlZOTyr6LXKt4Mv1adWypnxfSv0xLlru4CAgICDOSeg7FHVV9dMsKXyICAgIOtirg1lXWRwSFwY7KuWEB2hpIsSD0KvqctseOZh30+OuS8RZPK/g6pI4ZHiSe7Y3OF3stcNJF+Is2uvyzMR2adtDiiJmN1d4DoRUShj3FrcnKcW8q12tAF+1w08wutXPknHXdl4McZLbTw6ONGBI6U/RPcbFgeHFptnGucyxaLamOuO1unTYcdNqLX83/bOupwVpwlPBThknLo3m9hnI78w0B7R52PmVU8Rw7TGSPsteH5t4nHLu8I+DBPQPfbjw/Sg9g5Y7sm58gq2iy9GWP5Wdbi68U/wppb7BEGCgmapLqIT8t3iO8q5HCnPLRSgQEHUxdwHJXTCKPQBpe8jisb0nt6BzrjnzRhrvLvgwzlttD2Y70EFLUtgpzcMhaHm93F5Lico9Ni30XPSXtek3t7y+9XWtbxSvslWAsf6anpYYXxylzI2tJDW2uBzcZU8ugyXvNo27yuYtbSlIrPsiGOGF2VtWZ4g4MMbG2eADdoN9RKu6XFOLH0zyo6rLGXJ1Rw4isq4gICjdOzs4me8ab4w3FV9X6NnfSetWF31Y+jf4HbisCvMN+0RtL87Ben27PMyypQICc8H3EEj4PPecH8/yOVTW+jK3ovVhcGFx/u03wJPkKw6eaG5fyyoGhqnwubJG7JeNR0Hm0gg6COwr0t6Vt2l5nHea7TD74QwnLUZIkcC1t8lrWhrRfWbDWT2r5x4q08rpky2v5nvxKqDHhGmI55cg9zwW/rfyXLV13xWfeknbLVdldEHxSMOkOjc09xBBWBSdpiW/eN4mH54tbQvTvMz27ClDBQTNUl1EJ+W7xHeVcjhTnlopQIPtRUr5pWRRjKe9wa0dp3DnXxe8UrNp9n3Sk3tFYWnhB8eA8HBkVjUP0BxGl8luM89jRzdw51j0i2qzbzw2LzXTYdo5VO95cS5xLnEkkk3JJ1knnK2oiIjaGLaZmd591t4t4p0UtHBJJTNc90LXON3aSRpOtYmbU5YyWiJ7btvDpsU0iZhBMfcHxU1c6KFgjYI2HJF7XINzpWlo8lr4+q0+7N1mOuPJtWEsxDxapKmhbLNA17y94JJdqDiBqKo6rUZaZZiJXtLp8V8cTaqQ/sVg/7q3a7+qr/i837lj8Hg/bDBxKoPurdrv6qPxmb9x+Dw/tRLHLENkETqikyg1gynxuOVZvO5pOnRrsbq7ptdabRW/upanQ1rWbU9kZxL9403xhuKt6r0bKuk9aq83NBBB1EWK8+30LxpxUo4aKeWOnax7YiWuBdoI59au4dTltkisypZ9PirjtMRsrrF3AUtfNmotAAu951MHT2nsWtqM9cNd5ZeDDOa20LTwXiJRQNGVFn387pdOxuobFjZNbltPOzXx6PFX23eypxSoZG2NJE3tY3IO1tlzjU5Y/VLpOmxTzWFcY6YnOobSxOMlOTbTymE6g7pHb/6dXS6v6n5LdpZeq0n0/zRw83B57zg/n+Ry+9b6MvjRerC4MMfu03wJPkKw6eaG3fyy/PbdQ7l6eeXmK8Mol28SqcyYRpmjmlyz3MBd+nqq2rttiss6SvVlqu6rkDY3uOoMcT3AErAr3mIb1p2iX52Jvp6dK9O8zPedxShgoJmqS6iE/Ld4jvKuRwpzy0UoEFj8FOBhZ9Y8abmOP8A1uHoPIrJ8Ry9/pw1fD8UbfUlHOEDCvtNc8A3jivE3ouDxz5u+UK3osX08ffme6rrcs3ybRxCNq2qL3xQ9303wGbl5zUerb7vR4PTr9lZ8J3vJ3wY9xWtoPR/tla/1f6hOODL3az4knzFZ2u9aWhofRhxuE/Ck9PLAIZ3xAxvJDHEXIItey7+H4qX36o3cNflvTbpnZwcUsZas10DH1MkjHyBjmvdlAg9+oqxqtPijFNq12VtLqMk5Ira263algcxzTpBaQe4grGrMxMS2ZjeswpDE1tsJUw6JrehW/qvQn7MLTevH3XhUm0byNByHbisCvLenhQ0+HqqRhZJVSvY4Wc1zyQR0EL0VdPirMT0w87bPltvE2la/B7g0QUEbrceUZ1x5+MOKPJttpWLrMk3yz8R2bGkpFMUT8ozwjY2Sx1BpIJc0GtaZHNNnkuGUG35gAQdHSrWi09LV67q2t1F626KuHipjdPBUxiSd0kL3hr2vdlWyjbKBOkEEgqxqdNjtSZiNpV9PqclbxEzvErfwjRtqIXwvF2vYWnzGvy1rGpaazFobV6xas1lUGIMZZhWJjuU10rT3hjgfULb1c74Jn7MTSV2zRC3cMfu03wJPkKxKeaG3fyy/PbdQ7l6eeXl68MolY3BRgc/SVjhosY478+ovcPQbVleIZeMcfdq+H4tt8n9JJwgYREGD5dPGkGab/PcO/y5SqaTF15Yhb1eT6eKVKr0Dz4gwUEzVJdRCflu8R3lXI4U55aKUMONhdBeuD4RQYNaLWzVMXu8QaXu9brzl5+rl3+ZeipH0sW3xCjHOLiSdJJJPeda9FEbRs89M7zuwpQvfFD3fTfAZuXnNR6tvu9Hg9Ov2Vnwne8nfBj3Fa2g9H+2Vr/V/qE44MvdrPiSfMVna71paGh9GEb4Xvrqf4b/AJmq34b5bKniXNf7RfFH3hS/Hareq9K32VdL61V6y8k9x3Lz0N+eFHYn+86f4/6OW/qfQn7MHTf/AKI+67qv6t/gduKwa8t23D868y9P7PMz7v0BgAj2Ontq9nit3ZDV5rL55+8vS4vJH2eetw/RwyOjmqI2SNtlNcdIuARfyIPmvquLJaN6xLnbLirO1ph8f2pwf96h2hfX4fN+2Xz9fD8w2GN1B98i/Mo/DZf2yn8Vh/dCu8VZGvw5lMILXTzuaRqIIeQRtWnniY0sRP8ADNwTE6neFqYY/dpvgSfIVkU80fdr38svz23UO5enl5ivDvYqYtyV8thdsLSM5JbQB1W9Lj6c6ranURhrz3W9Np7Zbd+IXVSUzIY2xRtDWMaGtA5gFgWtNrbzy3a1itdo4VDwg4fFZU5EZvBFdrSNTnfbd6WHd2rb0WD6dOqeZYutzdd+mOIRZXVIQYKCZqkuohPy3eI7yrkcKc8tFKH0pWh0jGnUXtB7i4Ar5tO1Z+z6rG9oj+V544e76m33d+7SvPaf1a/d6HP6VvsohejecgQXtie4HB9Nb+A3cvOaj1Lfd6PT+lH2Vpwne8nfBj3Fa2g9H+2Tr/V/qE44MvdrPiSfMVna71paOh9GEb4Xvrqf4b/marfhvlsqeJc1/tF8UfeFL8dqt6r0rfZV0vrVXrLyT3HcvPQ354UXitKGYRp3ONh7QBtJA3r0OorvgmI+GBgt054n+V5ysymlvSCNosvPRPfdvzHspPCeJtZTMfI+IZpgJLw9trDnte/ot7HrMV5iN+7Cy6PJWJt7LH4O8JiegjZfjw/ROHPYDiHuybbCsvWY5rlmfaWno8nXjj5hycfsTpamT2mmAc8tAfGSAXW0BzSdF7aLHoC76PV1pXotw4avRze3XVD6TEmvkdk+zGMc7pHNDR63PkFevrMNY7TupV0eaZ42e/GbESSjhE0b880N+l0WLTzuA6nqFywa2Mlume3w659FbHXeO7w4gSBuEoCTrLh5ljgF11kb4Z/hy0c7Zo/lcWF/3ab4MnylYVPNDcv5ZUviVgdlbVthlLgzNl5ydBOTk8W/NrW9q8tsVOqvLB0eKuS+1l10VHHBG2KJgjY0aGtFh3/91g2vN7by361itdoQDH3HQFrqSlfe+iWRuoDnYw9PSVo6TR7/AJ7/ANM7V6yPJRXC1mSICDBQTNUl1EJ+W7xHeVcjhTnlopQ2jkyHB/VcHbDf9FExvEwmJ2mJfoKvgFRTyR3u2SFzb9j2kX9V5ms9Non4eltHVXZ+fZGFri1ws4EgjoINiNoXponeImHmpjadpaqUJpiTjqKNns9Q1zoQSWObpcy5JII5xc36detZ+q0c5LTajQ0usjHXptw5WPOEoqqtM0LsqMxsF7EaQDcWK7aPHamPpt8uOsyVvk6q/CT4kY3UlJRNhmkc14e8kCN5Fi640gWVPV6bJfLMxC5pdVjpjiJlxeEPDsFbJC6neXBrHB12ubpJFuUB0KxocN8cW6oV9bmpk26XDxeqmw1cEshsxkrXOIBOgdg0lWM9JvimIV8F4pliZWm/hAoCCM87V/Ck/tWNGjzfDX/G4uN1OuOkkdN/Vb0R2iJYkz+aZhZGL/CQwRtZWMdlgWzjACHdrm6we66ys3h1t96NTD4hXba77Yy470dRRzwxveXvjLW3jcBc9vMvjDo8tckWmH1m1mK2OYieUBwDhuWhmzsJ5rOa7kvHQf68y1M+Guau1mZhzTit1VWZg3hFo5AM7lQP5w5pc3yc3m7wFkX0OWJ7Ru16a3FMd52e6bHmgaL+05XY1jydy5xo837X3Orwx+pD8Z+EJ0zTFSNdEwizpHWyyOcNA5Pfr7le0+g6Z3upajX7xtRB4ZXMc17Dkua4OaRrBBuCPNaNoi0bSzotMTvCwqfhGZJTPiqIXCUxOblR2LSS0gEgkFvqsq3h9otE0ns1K6+s02vHdFsSsLx0NVnpQ4tEL2gMFyScmw09xV3V4rZabQp6TLXFfeXtxlx4nrAY2fQQHQWtPGcPxO/Qeq54NFTHta3eXTPrb5Py17Qiyu/wpfyICAgwUEzVJdRCflu8R3lXI4U55aKUCC8MR8I+00ELr8Zrc2/vZxfUAHzXntVT6eWYeh0uT6mKJQLhKwAYKg1LG/Qym7rfZk57+LX33WjoM/VXonmP/jO12Dpt1xxKGLQZ4gJ2BO52ET2ER9xO52EBRtCe4pQJsCG0CAiREPXg3Bk1U/IgidI7s1Dtc46B5rnky0xxvaXTHitknasN8NYLfRzGCQgva1pOTq4wBtp71GHLGSvVCc2KcdumXhXVyEBAQEGCgmapLqIT8t3iO8q5HCnPLRSgQSzg8xhFJUGKQ2glIBJ1Nfqa49AOo+XQqOtwfUp1V5he0WeKW6bcStuspGTxujlaHscLEHUQsWtprO8Nm1YtXaVRY1YkzUZMkQM1PruBd7B0PA5vxD0W1ptZXJ2t2li6jRWx9694RQK8pMoCAgICAgICAgICgd3BWKFZU2LYCxvXl4jfXSfIKvk1eLH+reVnHpMt/wBOya4G4NYWWdUyGZ3UbxY/P7R2hZ+XxC9o2rGy/i8PpWd7TumtJRxwsDIo2xsGprAAPRULWm3e0r9aVrG0Qp7hH95zeGP5AtzQ+jDE13rSjKuKYgICAgwUEzVJdRCflu8R3lXI4U55aKUCAgsDEjHjNhtNWO4gsI5TpyRzNf2du3pWXq9F+vG1NLrNvyXWYx4cAQQQRoI0ghZUw1I2lHcNYlUlUS4x5qQ/biOTfvbyTsurOLWZMfbfdWy6THk5jaflDsI8GdQy5gmZMOh12O/UeoV+niNJ80bKN/Drx5ZR+rxTrouVSSHwDL+S6sU1WK3urX0uWvs5stFKzlQyN8UbhvC7RkrPEx/tyml45if9PiQRrBHkvrd87T8Swm8fJtPw3bE46muPcCo64+U9FviXohwVUP5FNM7wxPO4L5nNjjmY/wBvqMV54rP+nTpsTa+TVSub4y1u83XG2sw19/8ATrXR5re3+3Zo+DOpd9bLFEOzKedwHquF/EaR5Y3d6+HX/VKQUHBpSs0zSSTHoByG7G6fVVb+I5J42hap4fjjneUnwbgOmpvqYGRnpAu78x0+qq3y3vzK3TFSvEOgubo+c87I2l73hjRrc4gAeZUxWZnaIRMxEbzKG4d4RaeG7aZvtD+nS2Meet3ltVzFoL383ZRza+lPL3lWeFsJSVczp5SC91r5IsAALAAdy2MWKMdemGTlyWyW6peNdHMQEBAQYKCZqkuohPy3eI7yrkcKc8tFKBAQEHcxexqqaE2jflxc8b7lv8vVPcq2fS0y955WcOqvi7eyxMDcINJPZspNM/ofpZfseNG2yy8uhyU7x3hqYtbjv2ntKVwzNkaHMcHtOotII2hU5rMcrcTE8N1CRBoYWn7I2BTvJsxmGdRuwKd5Rs3a0DUAO4KN5TsygIAUDzVlfFCLyysjH43Ab191pa3EPi1615lHMIcIVFFcMc6d3RG02/M6w2K1j0OW/tsrZNdip/KK4U4S6h+iCJkI6Xcd/wCgGwq5j8PpHmndTyeIXnyxtCI4QwlNUOyp5nyn8TiQO4ah5K7jxUx+WFK+S9/NLyro5iAgICAgIMFBM1SXUQn5bvEd5VyOFOeWilAgICAgJHY5fakq5ITlRSOid0scW7ba18WpW3mh91vevll3aPHmvi/4+cHRIxp9QAfVV7aHDb22WK63NX3daDhOqRy4In92W07yuM+HU9pl2jxG/vD2M4Uj9qjHlL/Vq5/43/ydI8Sj9rf/AGpD7mf+r/4qP8bP7k/5KP2tH8KR+zRjzl/o1T/jZ/cifEo9qvLLwnznkU0TfE57t1l9x4bT3mXxPiVvarn1HCHXP1Ojj8EY/wBRK6xoMUc7y5W1+WfiHIq8ZKyX6yrlPYHZI2MsF2rpsVeKuNtTltzLlnSbnSek69q7REQ4zMzyKUCAgICAgICAgIMFBM1SXUQn5bvEd5VyOFOeWilAgICAgICAgICAgICAgICAgICAgICAgICAgwUEzVJdRCflu8R3lXI4U55aKUCAgICAgICAgICAgICAgICAgICAgICAgICDBQTNUl1EJ+W7xHeVcjhTnlopQICAgICAgICAgICAgICAgICAgICAgICAgIMFBM1SXUQn5bvEd5VyOFOeWilAgICAgICAgICAgICAgICAgICAgICAgICAgwUEzVJdRCflu8R3lXI4U55aKUCAgICAgICAgICAgICAgICAgICAgICAgICDBQTNUl1D5jx3eI7yrkcKc8tLqUF0C6BdAugXQLoF0C6BdAugXQLoF0C6BdAugXQLoF0C6BdAugXQLoF0AlBM7qluu7N38o953pCZYQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEApI76qrD/2Q=='>"
    }
}
reportHeader = []
reportData = []


def GetCurrentTimestamp(timestampformat=None):
    if timestampformat is None:
        timestampformat = DefaultTimeStampFormat
    timstamp = datetime.datetime.fromtimestamp(time.time())
    return timstamp.strftime(timestampformat)


def GetCurrentTimestamp(timestampformat=None):
    if timestampformat is None:
        timestampformat = DefaultTimeStampFormat
    timstamp = datetime.datetime.fromtimestamp(time.time())
    return timstamp.strftime(timestampformat)


def CloseReport(reportHeader, reportData):
    reportData.append('</table>')
    reportData.append('</body>')
    reportData.append('</html>')
    cwd = os.getcwd()
    filename = os.path.join(cwd,'SATReport_{}.html'.format(GetCurrentTimestamp('%Y-%m-%d-%H-%M-%S')))

    try:
        url = 'file://{0}'.format(filename)
        f = open(filename, 'w')
        for line in reportHeader:
            f.write(line)
        for line in reportData:
            f.write(line)
        f.flush()
        webbrowser.open(url, 2)
    except Exception as e:
        print (str(e))


def InsertReportHeader(testid):
    reportData.append('<table cellspacing="0" cellpadding="0" border="0" style="width: 100%;">')
    reportData.append('<tr style="border:none;">')
    reportData.append(
        '<th colspan="8" style="border:1px; width:100%; height: 40px;background-color:dimgrey; font-family:arial,helvetica; font-size:smaller; font-weight:bold; color:white;">')
    reportData.append('Test ID : %s' % testid)
    reportData.append('</th>')
    reportData.append('</tr>')
    reportData.append('</table>')
    reportData.append('<table cellspacing="1" border="0" style="width: 100%; border-color:silver">')

    toggle = True
    for name in ['objective', 'testProcedure', 'pass/failCreterial']:
        if toggle:
            bkcolor = RESOURCES['COLOR']['WHITE']
        else:
            bkcolor = RESOURCES['COLOR']['SILVER']
        InsertRow(name, bkcolor)
        toggle = not toggle


def InsertRow(self, name, bkcolor, val=None, color=None):
    if color is None:
        color = 'transparent'
    self._reportData.append(
        '<tr style="height: 28px;background-color:%s;font-size:8pt;font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;text-align:center;color: black">' % bkcolor)
    self._reportData.append('<td style="width:10%;font-weight:bold;color:navy">{0}</td>'.format(name))
    try:
        if val is None:
            self._reportData.append(
                '<td style="width:60%;background-color:{1}">{0}</td>'.format(self._configTest[name], color))
        else:
            self._reportData.append('<td style="width:60%;background-color:{1}">{0}</td>'.format(val, color))
    except Exception as e:
        self._reportData.append('<td style="width:60%;background-color:{1}">{0}</td>'.format(str(e), color))

    self._reportData.append('</tr>')
    pass

def insertReportSubHeader(title, columns, reportData, appendIcon = True):
    reportData.append('<table cellspacing="0" border="0" cellpadding="0" border="0" style="width: 100%;;text-align:center">')
    reportData.append('<tr style="border:none;">')
    reportData.append(
        '<th colspan="8" style="border:1px; width:100%; height:25px;background-color:rgb(87, 133, 224); font-family:arial,helvetica; font-size:smaller; font-weight:bold; color:white;text-align:center;">')
    reportData.append(title)
    reportData.append('</th>')
    reportData.append('</tr>')
    reportData.append('</table>')

    reportData.append('<table cellspacing="1" border="0" style="width: 100%; border-color:white;font-size:8pt;background-color:{0};text-align:center;">'.format(RESOURCES['COLOR']['LIGHYELLOW']))
    reportData.append('<tr>')
    if appendIcon:
        width = 98 / len(columns)
        for i in range(0, len(columns) - 1):
            reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(width, columns[i]))
        reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(2, columns[len(columns) - 1]))
    else:
        width = 100 / len(columns)
        for i in range(0, len(columns) - 1):
            reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(width, columns[i]))

    reportData.append('</tr>')
    reportData.append('</table>')
    reportData.append('<table cellspacing="1" border="0" style="width:100%; border-color:silver;font-size:8pt;text-align:center">')

def insertSubRow(rowdata, reportData, bkcolor, appendIcon = True):
    reportData.append(
        '<tr style="height: 20px;background-color:{0};font-size:8pt;font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;text-align:center;color:black;font-size:8pt">'.format(bkcolor))
    if appendIcon:
        width = 98/len(rowdata)
        for i in range(0, len(rowdata) - 1):
            reportData.append('<td style="width:{1}%;background-color{2};">{0}</td>'.format(rowdata[i], width, bkcolor))
        reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(2, rowdata[len(rowdata) - 1]))
    else:
        width = 100 / len(rowdata)
        for i in range(0, len(rowdata) - 1):
            reportData.append('<td style="width:{1}%;background-color{2};">{0}</td>'.format(rowdata[i], width, bkcolor))



def CloseReportRow():
    reportData.append('</table>')
    reportData.append('<br/>')


def _insertReportSubHeader(title, columns, reportData, appendIcon=True):
    reportData.append(
        '<table cellspacing="0" border="0" cellpadding="0" border="0" style="width: 100%;;text-align:center">')
    reportData.append('<tr style="border:none;">')
    reportData.append(
        '<th colspan="8" style="border:1px; width:100%; height:25px;background-color:rgb(87, 133, 224); font-family:arial,helvetica; font-size:smaller; font-weight:bold; color:white;text-align:center;">')
    reportData.append(title)
    reportData.append('</th>')
    reportData.append('</tr>')
    reportData.append('</table>')

    reportData.append(
        '<table cellspacing="1" border="0" style="width: 100%; border-color:white;font-size:8pt;background-color:{0};text-align:center;">'.format(
            RESOURCES['COLOR']['LIGHYELLOW']))
    reportData.append('<tr>')
    if appendIcon:
        width = 98 / len(columns)
        for i in range(0, len(columns) - 1):
            reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(width, columns[i]))
        reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(2, columns[len(columns) - 1]))
    else:
        width = 100 / len(columns)
        for i in range(0, len(columns) - 1):
            reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(width, columns[i]))

    reportData.append('</tr>')
    reportData.append('</table>')
    reportData.append(
        '<table cellspacing="1" border="0" style="width:100%; border-color:silver;font-size:8pt;text-align:center">')


def _insertSubRow(rowdata, reportData, bkcolor, appendIcon=True):
    reportData.append(
        '<tr style="height: 20px;background-color:{0};font-size:8pt;font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;text-align:center;color:black;font-size:8pt">'.format(
            bkcolor))
    if appendIcon:
        width = 98 / len(rowdata)
        for i in range(0, len(rowdata) - 1):
            reportData.append('<td style="width:{1}%;background-color{2};">{0}</td>'.format(rowdata[i], width, bkcolor))
        reportData.append('<td style="width:{0}%;font-weight:bold;">{1}</td>'.format(2, rowdata[len(rowdata) - 1]))
    else:
        width = 100 / len(rowdata)
        for i in range(0, len(rowdata) - 1):
            reportData.append('<td style="width:{1}%;background-color{2};">{0}</td>'.format(rowdata[i], width, bkcolor))


def _flushSubTable(tag, tagColor, reportData):
    reportData.append('</table>')
    reportVal = ''
    for item in reportData:
        reportVal += item
    InsertRow(tag, tagColor, reportVal)


class SAT:
    def __init__(self,
                 config,
                 sut,
                 loops,
                 skip,
                 logger,
                 delay):
        self._delay = delay
        self._loops = loops
        self._sut = sut
        self._power_switch_port = int(config['port'])
        self._SKIP_INIT_AC = skip

        self._reportHeader = reportHeader
        self._reportData = reportData

        self._logger = logger

        power_switch_ip = config['power_switch_ip']
        power_switch_user = config['power_switch_user']
        power_switch_password = config['power_switch_password']
        self._switch_access = {"hostname": power_switch_ip,
                               "userid": power_switch_user,
                               "password": power_switch_password}
        self._logger.info('Connecting to a DLI PowerSwitch at {}'.format(power_switch_ip))
        try:
            self.switch = dlipower.PowerSwitch(hostname=power_switch_ip,
                                               userid=power_switch_user,
                                               password=power_switch_password)
            self.get_switch()
            self._logger.info('SAT config success.')
        except Exception as e:
            self._logger.error(str(e))

    def get_switch(self):
        if self.switch is None:
            self.switch = dlipower.PowerSwitch(**self._switch_access)
        if not self.switch.verify():
            self._logger.info("Could not connect to the power switch.")
        return self.switch

    def _isPowerOFF(self):
        return self.get_switch()[self._power_switch_port - 1].state == "OFF"

    def _isPowerON(self):
        return self.get_switch()[self._power_switch_port - 1].state == "ON"

    def power_on(self):
        if self._isPowerOFF():
            self._logger.info('Turning on outlet {}'.format(self._power_switch_port))
            self.get_switch().on(self._power_switch_port)
            if not self._isPowerON():
                self._logger.info("Power outlet state is {}".format(self.get_switch()[self._power_switch_port].state))

    def power_off(self):
        if self._isPowerON():
            self._logger.info('Turning off outlet {}'.format(self._power_switch_port))
            self.get_switch().off(self._power_switch_port)
            if not self._isPowerOFF():
                self._logger.info("Power outlet state is {}".format(self.get_switch()[self._power_switch_port].state))

    def warm_reboot_test(self):
        self._logger.info('warm reboot test start...')
        start_time = time.time()
        i = 1
        if not self._SKIP_INIT_AC:
            self._logger.info('Doing a init AC cycle')
            self.power_off()
            self.power_on()
        self._sut.wait_for_ssh_connection()
        self._sut.connect()
        namespaces = self._sut.ndctl_get_namespace()
        if len(namespaces) == 0:
            self._sut.switch_mode('AD')
            namespaces = self._sut.ndctl_get_namespace()
        self._sut.verify_file_md5_on_aep(namespaces, init_fs=True)
        while True:
            if int(i) >= int(self._loops):
                break
            self._logger.info('warm reboot test loop: {}'.format(i))
            self._sut.os_reboot()
            self._sut.connect()
            namespaces_current = self._sut.ndctl_get_namespace()
            if cmp(namespaces, namespaces_current) != 0:
                self._logger.info('Namespace info changed after reboot')
                #sys.exit()
                insertReportSubHeader('warm_reboot_test',
                                      ['Namespace info changed after reboot', 'namespaces', 'namespaces_current', 'Pass/Fail'],
                                      reportData)
                insertSubRow([namespaces, namespaces_current, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])
                break
            if not self._sut.verify_file_md5_on_aep(namespaces_current):
                self._logger.info('File md5 changed after reboot')
                #sys.exit()
                insertReportSubHeader('warm_reboot_test',
                                      ['Namespace info changed after reboot', 'namespaces', 'namespaces_current', 'Pass/Fail'],
                                      reportData)
                insertSubRow([namespaces_current, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])
                break
            i += 1
        elapsed_time = round(time.time() - start_time, 1)
        self._logger.info('warm reboot test finished, took {}s!'.format(elapsed_time))
        insertReportSubHeader('warm_reboot_test',
                              ['Loop', 'Pass/Fail'],
                              reportData)
        insertSubRow([str(i), RESOURCES['ICON']['CHECK_MARK_BLUE']], reportData, RESOURCES['COLOR']['WHITE'])


    def ac_cycle_test(self):
        self._logger.info('AC cycle test start...')
        start_time = time.time()
        i = 1
        if not self._SKIP_INIT_AC:
            self.power_off()
            self.power_on()
        self._sut.wait_for_ssh_connection()
        self._sut.connect()
        namespaces = self._sut.ndctl_get_namespace()
        if len(namespaces) == 0:
            self._sut.switch_mode('AD')
            namespaces = self._sut.ndctl_get_namespace()
        self._logger.info(namespaces)
        self._sut.verify_file_md5_on_aep(namespaces, init_fs=True)
        while True:
            if int(i) > int(self._loops):
                break
            self._logger.info('AC cycle test loop: {}, target loops = {}'.format(i, self._loops))
            self.power_off()
            self.power_on()
            self._sut.wait_for_ssh_connection()
            self._sut.connect()
            i += 1
            namespaces_current = self._sut.ndctl_get_namespace()
            self._logger.info('loop: {} {}'.format(i, namespaces_current))
            if cmp(namespaces, namespaces_current) != 0:
                self._logger.info('Namespace info changed after AC cycle')
                #sys.exit()
                insertReportSubHeader('ac_cycle_test',
                                      ['Namespace info changed after AC cycle', 'namespaces', 'namespaces_current', 'Pass/Fail'],
                                      reportData)
                insertSubRow([namespaces, namespaces_current, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])
                break

            if not self._sut.verify_file_md5_on_aep(namespaces_current):
                self._logger.info('File md5 changed after AC cycle')
                #sys.exit()
                insertReportSubHeader('ac_cycle_test',
                                      ['Namespace info changed after AC cycle', 'namespaces', 'namespaces_current', 'Pass/Fail'],
                                      reportData)
                insertSubRow([namespaces, namespaces_current, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])
                break
        elapsed_time = round(time.time() - start_time, 1)
        self._logger.info('AC cycle test finished, took {}s!'.format(elapsed_time))
        insertReportSubHeader('ac_cycle_test',
                              ['Loop', 'Pass/Fail'],
                              reportData)
        insertSubRow([str(i - 1), RESOURCES['ICON']['CHECK_MARK_BLUE']], reportData, RESOURCES['COLOR']['WHITE'])

    def provision_test(self, mode):

        self._logger.info('{} provision test start...'.format(mode))
        if not self._SKIP_INIT_AC:
            self.power_off()
            self.power_on()
        i = 1
        while True:
            if int(i) > int(self._loops):
                break
            self._logger.info('{} provision test loop: {}'.format(mode, i))
            self._sut.wait_for_ssh_connection()
            self._sut.connect()
            self._sut.switch_mode(mode)
            self._logger.info('Current memory resources info:{}'.format(self._sut.get_memory_resource()))
            i += 1
        self._logger.info('{} provision test finished.'.format(mode))

        insertReportSubHeader('provision_test'.format(mode),
                              ['Mode', 'Loop', 'Pass/Fail'],
                              reportData)
        insertSubRow([mode, str(i - 1), RESOURCES['ICON']['CHECK_MARK_BLUE']], reportData, RESOURCES['COLOR']['WHITE'])


class CentOS(object):
    def __init__(self, ip, username, password, logger, delay):
        self._delay = delay
        self._ip = ip
        self._username = username
        self._password = password
        self._ssh = None
        self._memory_resources = {}
        self._pools = []
        self._namespaces = {}
        self._mode = 'unknown'
        self._logger = logger

    def connect(self):
        self._ssh = paramiko.SSHClient()
        self._ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        try:
            self._ssh.connect(self._ip, 22, self._username, self._password, timeout=None, auth_timeout=None)
            self._logger.info("Accessed to server: {}".format(self._ip))
        except Exception as e:
            self._logger.info("Failed to access server: {}".format(str(e)))
            #sys.exit(-1)
            insertReportSubHeader('connect',
                                  ['Failed to access server', 'Pass/Fail'],
                                  reportData)
            insertSubRow([self._ip, RESOURCES['ICON']['CROSS_RED']], reportData,
                         RESOURCES['COLOR']['WHITE'])

    def disconnect(self):
        try:
            self._ssh.close()
        finally:
            self._ssh = None
        self._logger.info("Closed ssh access to server: {}".format(self._ip))

    def wait_for_ssh_connection(self, timeout=None):
        self._logger.info('Waiting for ssh access')
        start_time = time.time()
        fnull = open(os.devnull, 'w')
        while 1:
            self._logger.info('attempt to access server...')
            stdout, stderr = subprocess.Popen('ping -n 3 {}'.format(self._ip), stdout=subprocess.PIPE,
                                              stderr=subprocess.PIPE).communicate()
            if 'TTL' in stdout:
                break
            time.sleep(self._delay)
            if timeout is not None and time.time() - start_time > timeout:
                self._logger.info('waiting for ssh access timeout: {}'.format(timeout))
                #sys.exit(-1)
                insertReportSubHeader('wait_for_ssh_connection',
                                      ['timeout', 'Pass/Fail'],
                                      reportData)
                insertSubRow([str(timeout), RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])
                break

        time.sleep(self._delay)
        self._logger.info('Ready for ssh connection.')
        return True

    def os_reboot(self):
        self._logger.info('Start to reboot OS...')
        self.run_cmd('reboot')
        start_time = time.time()
        time.sleep(self._delay)
        self.disconnect()
        self.wait_for_ssh_connection()
        time.sleep(self._delay)
        self.connect()
        end_time = round(time.time() - start_time)
        self._logger.info('Reboot completed, took {} seconds.'.format(end_time))

    def run_cmd(self, cmdline):
        if self._ssh is None:
            self.connect()
        try:
            stdin, stdout, stderr = self._ssh.exec_command(cmdline)
            output = stdout.read().rstrip('\n')
            errput = stderr.read().rstrip('\n')
            if re.search(r'failed|error', output, re.I):
                self._logger.info('Failed exec cmd: {}.\n{}'.format(cmdline, output))
                #sys.exit(-1)
                insertReportSubHeader('run_cmd',
                                      ['ailed exec cmd', 'Pass/Fail'],
                                      reportData)
                insertSubRow([cmdline, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])

            if re.search(r'failed|error', errput, re.I):
                self._logger.info('Failed exec cmd: {}.\n{}'.format(cmdline, errput))
                #sys.exit(-1)
                insertReportSubHeader('run_cmd',
                                      ['Failed exec cmd', 'cmd', 'error', 'Pass/Fail'],
                                      reportData)
                insertSubRow([cmdline, errput, RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])

            return output
        except paramiko.SSHException as e:
            self._logger.info('run cmd: {} failed. Error: {}'.format(cmdline, str(e)))
           # sys.exit(-1)
            insertReportSubHeader('run_cmd',
                                  ['Failed exec cmd', 'cmd', 'error', 'Pass/Fail'],
                                  reportData)
            insertSubRow([cmdline, str(e), RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])

    def query_pool(self):
        pools = []
        result = self.run_cmd('ipmctl show -a -o nvmxml -pool')
        root = etree.fromstring(result)
        for pool_tree in root.findall('Pool'):
            pool = {}
            for tag in ['PoolID', 'PersistentMemoryType', 'Capacity', 'FreeCapacity', 'SocketID']:
                pool.setdefault(tag, pool_tree.find(tag).text)
            pools.append(pool)
        return pools

    def verify_dimm(self):
        output = self.run_cmd('ipmctl show -dimm')
        for line in output.split('\n'):
            if line and 'DimmID' not in line:
                if 'Healthy' not in line:
                    self._logger.info('Dimm not healthy!')
                    return False

        return True

    def create_goal(self, mode):
        if mode == 'AD':
            self.run_cmd('ipmctl create -f -goal persistentmemorytype=appdirect')
            self._logger.info('Created AD goal')
            insertReportSubHeader('create_goal',
                                  ['Mod', 'Pass/Fail'],
                                  reportData)
            insertSubRow([mode,  RESOURCES['ICON']['CHECK_MARK_BLUE']], reportData, RESOURCES['COLOR']['WHITE'])

        elif mode == 'MM':
            self.run_cmd('ipmctl create -f -goal memorymode=100')
            self._logger.info('Created MM goal')
            insertReportSubHeader('create_goal',
                                  ['Mod', 'Pass/Fail'],
                                  reportData)
            insertSubRow([mode,  RESOURCES['ICON']['CHECK_MARK_BLUE']], reportData, RESOURCES['COLOR']['WHITE'])

        else:
            self._logger.info('Does not supporting create {} goals'.format(mode))
            #sys.exit()
            insertReportSubHeader('create_goal',
                                  ['Mod', 'Pass/Fail'],
                                  reportData)
            insertSubRow([mode,  RESOURCES['ICON']['CROSS_RED']], reportData, RESOURCES['COLOR']['WHITE'])

    def delete_goal(self):
        self.run_cmd('ipmctl delete -goal')
        self._logger.info('Delete goals.')

    def get_region(self):
        regions = []
        result = self.run_cmd('ndctl list -R -u')
        region_list = json.loads(result)
        for region in region_list:
            regions.append(region['dev'])
        return regions

    def ndctl_create_namespace(self, regions=None):
        self._logger.info('Start to create namespace...')
        regions = self.get_region()
        for region in regions:
            output = self.run_cmd('ndctl create-namespace -r {} -m fsdax -f --verbose'.format(region))
            namespace = json.loads(output)
            self._logger.info('Created namespace: {}'.format(namespace['dev']))

    def ndctl_delete_namespace(self, namespaces=None):
        if namespaces is None:
            self.run_cmd('ndctl destroy-namespace all -f')
            self._logger.info('Deleted all namespaces')
        else:
            for namespace in namespaces:
                self.run_cmd('ndctl destroy-namespace {} -f'.format(namespace))
                self._logger.info('Deleted namespace: {}'.format(namespace))

    def ndctl_get_namespace(self):
        self._namespaces = {}
        ndctl_info = self.run_cmd('ndctl list --namespaces -u')
        namespace_json_data = '[' + ndctl_info.lstrip('[').rstrip(']') + ']'
        namespace_list = json.loads(namespace_json_data)
        for i in namespace_list:
            self._namespaces.update({i['dev']: i})
        return self._namespaces

    def get_current_mode(self):
        self.get_memory_resource()
        if self._memory_resources['AppDirectCapacity'] == '0 B':
            self._mode = 'MM'
        elif self._memory_resources['MemoryCapacity'] == '0 B':
            self._mode = 'AD'
        return self._mode

    def get_memory_resource(self):
        self._memory_resources.clear()
        result = self.run_cmd('ipmctl show -o nvmxml -memoryresources')
        memory_resources_tree = etree.fromstring(result)
        for tag in ['Capacity', 'MemoryCapacity', 'AppDirectCapacity', 'UnconfiguredCapacity']:
            self._memory_resources.setdefault(tag, memory_resources_tree.find(tag).text.strip())
        return self._memory_resources

    def switch_mode(self, mode_to):
        self._logger.info('Start to change to {} mode'.format(mode_to))
        if self.ndctl_get_namespace():
            self.ndctl_delete_namespace()
        if mode_to == 'AD':
            self.create_goal('AD')
            self.os_reboot()
            self.ndctl_create_namespace()
        elif mode_to == 'MM':
            self.create_goal('MM')
            self.os_reboot()
        else:
            self.info('Unsupported mode: {}'.format(mode_to))
            sys.exit()
        self._logger.info('Changed to {} mode successfully'.format(mode_to))

    def verify_file_md5_on_aep(self, namespaces=None, init_fs=False):
        if not namespaces:
            namespaces = self.ndctl_get_namespace()
        if init_fs:
            self.run_cmd('dd if=/dev/zero of=/1M_file bs=1M count=1')
            for namespace in namespaces.values():
                pmem = namespace['blockdev']
                self.run_cmd('umount -f /dev/{}'.format(pmem))
                self.run_cmd('rm -rf /mnt/{}'.format(pmem))
                self.run_cmd('mkfs.xfs -f /dev/{}'.format(pmem))
                self.run_cmd('mkdir -p /mnt/{}'.format(pmem))
                self.run_cmd('mount -o dax /dev/{} /mnt/{}'.format(pmem, pmem))
                self.run_cmd('for i in {{1..10}};do cp -f /1M_file /mnt/{}/1M_file_$i;done'.format(pmem))
                self._logger.info('Inited files on aep pmem device: {}'.format(pmem))
        md5 = self.run_cmd('md5sum /1M_file | awk \'{print $1}\'')
        self._logger.info('md5 code is: {}'.format(md5))
        for namespace in namespaces.values():
            pmem = namespace['blockdev']
            self.run_cmd('umount -f /dev/{}'.format(pmem))
            self.run_cmd('mount -o dax /dev/{} /mnt/{}'.format(pmem, pmem))
            output = self.run_cmd('md5sum /mnt/{}/1M_file* | awk \'{{print $1}}\''.format(pmem))
            for line in output.split('\n'):
                if line != md5:
                    return False
        return True


if __name__ == '__main__':
    import argparse

    loops = 1
    skip = False
    parser = argparse.ArgumentParser()
    parser.add_argument('-j', action='store', dest='jsonfile', help="Config Json file path", default=None)
    parser.add_argument('-l', action='store', dest='loops', help="Loops count", default=None)
    parser.add_argument('-f', action='store', dest='filters', help="SAT test case filters", default=None)
    parser.add_argument('-s', action='store', dest='skip', help="Skip initial AC", default=None)
    args = parser.parse_args()
    if args.jsonfile is not None:
        jsonpath = args.jsonfile
    else:
        jsonpath = os.path.realpath(r'Json/AEPHealthCheck.json')
    config = json.loads(open(jsonpath).read())
    if args.loops is not None:
        loops = args.loops
    if args.skip is not None:
        skip = args.skip
    f = None
    if args.filters is not None:
        f = [x.strip().upper() for x in args.filters.split(',') if x != '']
    if args.skip is not None:
        if args.skip.lower() == 'true':
            skip = True
    logName = 'SAT'
    automationlog = AutomationLog(logName)
    logger = automationlog.GetLogger(logName)
    automationlog.TryAddConsole(logName)

    reportHeader.append('<html xmlns="http://www.w3.org/1999/xhtml">')
    reportHeader.append('<body style="background-color:{0};">'.format('rgb(225, 231, 242)'))
    reportHeader.append('<table cellspacing="0" cellpadding="0" border="0" style="height: 50px;width: 100%;'
                        'background-color:steelblue; font-family:arial,helvetica; '
                        'font-size:smaller; font-weight:bold; color:white;border-radius:5px;">')
    reportHeader.append('<tr style="border:none;">')
    reportHeader.append(
        '<th align=left style="padding-left:3px;">{0}</th><th>'.format(RESOURCES['ICON']['INTEL_LOGO']))
    reportHeader.append(
        'Apache Pass Health Check Report [ {0} ] on system @{1}'.format(GetCurrentTimestamp(), socket.gethostname()))
    reportHeader.append('</th></tr></table>')

    configClient = config['Client']
    sut = CentOS(configClient['ip'], configClient['user'], configClient['password'], logger, config['delay'])
    sat = SAT(config['PowerSwitcher']['DLIPowerSwitch'],
              sut,
              loops,
              skip,
              logger,
              config['delay'])
    if 'AC' in f:
        sat.ac_cycle_test()
    if 'AD' in f:
        sat.provision_test('AD')
    if 'MM' in f:
        sat.provision_test('MM')
    if 'WR' in f:
        sat.warm_reboot_test()
    CloseReport(reportHeader, reportData)

